<!--
TODO
- Modifier l'image par défaut de gravatar
- Mettre en place le menu de like, unlike, tweet, facebook....
-->

<div class="vide"></div>
<?php foreach ($this->messages as $entry): ?>
<div class="message" onclick="javascript:afficher_cacher('message<?php echo $this->escape($entry->idMessage) ?>');">
    <!--<div class="avatar"><img alt="avatar" src="<?php echo $this->baseUrl() ?> /images/avatar.png"/></div>-->
    <div class="avatar"><?php echo $this->gravatar($entry->getUserEmettre()->emailUser)?> </div>
    <div class="dateMessage"><?php echo $this->escape($this->dateMessage($entry->dateActiviteMsg)) ?></div>
    <div class="nomUser"><?php if($entry->idUser_emettre != null) echo $this->escape($entry->getUserEmettre()->nomUser)?></div>
    <div class="nbMessage"><!--<img class="icone" alt="home" src="<?php echo $this->baseUrl() ?> /images/message.png"/>--><span>4</span></div>
    <div class="lblMessage"><?php echo $this->escape($entry->lblMessage) ?></div></br>
</div>  
<div class="menuMessage" id="message<?php echo $this->escape($entry->idMessage) ?>" >
    <ul>
        <li><a href="" ><img class="icone" alt="home" src="<?php echo $this->baseUrl() ?> /images/rep.png"/></a></li>
        <li><a href="" ><img class="icone" alt="home" src="<?php echo $this->baseUrl() ?> /images/plus.png"/></a></li>
        <li><a href="" ><img class="icone" alt="home" src="<?php echo $this->baseUrl() ?> /images/moins.png"/></a></li>
        <li><a href="" ><img class="icone" alt="home" src="<?php echo $this->baseUrl() ?> /images/face.png"/></a></li>
        <li><a href="" ><img class="icone" alt="home" src="<?php echo $this->baseUrl() ?> /images/twit.png"/></a></li>
        <li><a href="" ><img class="icone" alt="home" src="<?php echo $this->baseUrl() ?> /images/suppr.png"/></a></li>
        
    </ul>
    <!--<div class="moderation"><?php echo $this->notationMessage($entry->idMessage) ?></div>-->
</div>

 <!-- Appel de la fonction pour cacher les menus des messages -->
 <script type="text/javascript">
 //<!--
    afficher_cacher('message<?php echo $this->escape($entry->idMessage) ?>');
 //-->
 </script>
    <?php endforeach ?>
 <!-- Test si l'utilisateur est bien loggé -->
    <?php  if (!is_null($this->formEcrireMessage)) {?>
           <div id="menuEcrire" onclick="javascript:afficher_cacher('ecrireMessage');">
               <img class="bulle" alt="home" src="<?php echo $this->baseUrl() ?> /images/message.png"/><span>Ecrire un message</span>
           </div>
           <div id="ecrireMessage">
           <?php echo $this->formEcrireMessage ; ?>
               <div onclick="javascript:afficher_cacher('ecrireMessage');"> <p>Fermer le formulaire</p></div>
           </div>
           
     <?php   }
     ?>      
 <!-- Appel de la fonction pour cacher le formulaire -->
 <script type="text/javascript">
 //<!--
    afficher_cacher('ecrireMessage');
 //-->
 </script>
    
    
 
 
 
 
 
    <!--ANCIEN CODE QUI PEUT SERVIR
    
    <div><?php echo $this->notationMessage($entry->idMessage) ?></div>
    <div><?php echo 'note : '.$entry->getNote() ?></div>
    <div><?php echo $this->moderationMessage($entry->idMessage) ?></div>
    <dd><?php if($entry->idTypeMsg != null) echo 'Type du message : ' . $this->escape($entry->getType()->lblTypeMsg)?></dd>
    -->
    
    <!--
    <dd><?php echo $this->escape($entry->dateActiviteMsg) ?></dd>
    <dd><?php echo ($entry->estActifMsg=='1')?'Message Actif':'Message inactif' ?> : 
    
            <?php //echo $this->formModererMessage ?></dd>
    <dd><?php if($entry->idEvent != null) echo 'Evenement : ' . $this->escape($entry->getEvent()->titreEvent)?></dd>
     <dd><?php if($entry->idProfil != null) echo 'Type du profil : ' . $this->escape($entry->getProfil()->nomProfil)?></dd>
     <dd><?php if($entry->idUser_moderer != null) echo 'Moderateur : ' . $this->escape($entry->getUserModerer()->nomUser)?></dd>
     <?php 
     echo 'Liste des utilisateurs qui ont appréciés : <br/>';
    //Recherche et affiche les utilisateurs d'un message
    $app = $entry->getAppreciers();
     foreach ($app as $appreciation){
         echo '<dd>Utilisateur : ' . $appreciation->getUser()->loginUser . 
                 ' - Appréciation : ' . $appreciation->evaluation . '</dd>'; 
     }
     ?>-->

 
